---
title: 大量編輯內容搜尋
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid: MOE150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
description: 使用大量搜尋編輯器在 Office 365 或 Microsoft 365 安全性與合規性中心] 中，可快速變更一或多個內容搜尋的查詢及內容位置。
ms.openlocfilehash: 3a484ad689b1c638e0e14ed1643edea0f2f56c09
ms.sourcegitcommit: 6c9340e4eb221bf81472ff3f1ae25ae21aaf5297
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/11/2019
ms.locfileid: "31813934"
---
# <a name="bulk-edit-content-searches"></a><span data-ttu-id="88176-103">大量編輯內容搜尋</span><span class="sxs-lookup"><span data-stu-id="88176-103">Bulk edit Content Searches</span></span>

<span data-ttu-id="88176-104">您可以使用 「 內容搜尋 」 工具中的大量搜尋編輯器來編輯在同一時間的多個搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-104">You can use the Bulk Search Editor in the Content Search tool to edit multiple searches at the same time.</span></span> <span data-ttu-id="88176-105">使用此工具可讓您快速變更一或多個搜尋的查詢及內容位置。</span><span class="sxs-lookup"><span data-stu-id="88176-105">Using this tool lets you quickly change the query and content locations for one or more searches.</span></span> <span data-ttu-id="88176-106">然後您可以重新執行搜尋，並取得新的預估的搜尋結果的修訂的搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-106">Then you can re-run the searches and get new estimated search results for the revised searches.</span></span> <span data-ttu-id="88176-107">在編輯器也可讓您複製並貼上查詢與從 Microsoft Excel 檔案或文字檔的內容位置。</span><span class="sxs-lookup"><span data-stu-id="88176-107">The editor also lets you copy and paste queries and content locations from a Microsoft Excel file or text file.</span></span> <span data-ttu-id="88176-108">這表示您可以使用搜尋統計資料] 工具來檢視一或多個搜尋的統計資料、 統計資料匯出至 CSV 檔案，您可以在其中編輯查詢與 Excel 中的內容位置。</span><span class="sxs-lookup"><span data-stu-id="88176-108">This means you can use the Search Statistics tool to view the statistics of one or more searches, export the statistics to a CSV file where you can edit the queries and content locations in Excel.</span></span> <span data-ttu-id="88176-109">然後您可以使用大量搜尋編輯器將修改過的查詢及內容的位置新增至搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-109">Then you use the Bulk Search Editor to add the revised queries and content locations to the searches.</span></span> <span data-ttu-id="88176-110">您已修訂一或多個搜尋之後，您可以重新啟動它們，並取得新的預估的搜尋結果。</span><span class="sxs-lookup"><span data-stu-id="88176-110">After you've revised one or more searches, you can re-start them and get new estimated search results.</span></span>
  
<span data-ttu-id="88176-111">如需使用搜尋統計資料] 工具的詳細資訊，請參閱 <<c0>檢視的內容搜尋結果的關鍵字統計資料。</span><span class="sxs-lookup"><span data-stu-id="88176-111">For more information about using the Search Statistics tool, see [View keyword statistics for Content Search results](view-keyword-statistics-for-content-search.md).</span></span>
  
## <a name="use-the-bulk-search-editor-to-change-queries"></a><span data-ttu-id="88176-112">使用大量搜尋編輯器]，以變更查詢</span><span class="sxs-lookup"><span data-stu-id="88176-112">Use the Bulk Search Editor to change queries</span></span>

1. <span data-ttu-id="88176-113">移至 [ [https://protection.office.com](https://protection.office.com)，然後按一下 [**搜尋** \> **內容搜尋**。</span><span class="sxs-lookup"><span data-stu-id="88176-113">Go to [https://protection.office.com](https://protection.office.com), and then click **Search** \> **Content search**.</span></span>
    
2. <span data-ttu-id="88176-114">在 [搜尋] 清單中選取一或多個搜尋，然後按一下 [**大量搜尋編輯器**![大量搜尋編輯器按鈕](media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png)。</span><span class="sxs-lookup"><span data-stu-id="88176-114">In the list of searches, select one or more searches, and then click **Bulk Search Editor** ![Bulk Search Editor button](media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png).</span></span>
    
    ![選取一或多個搜尋，然後按一下 [大量搜尋編輯器](media/600c9716-89a2-4451-b111-fa7cfaad2006.png)
  
    <span data-ttu-id="88176-116">在 [**查詢**] 頁面上的大量搜尋編輯器中，會顯示下列資訊。</span><span class="sxs-lookup"><span data-stu-id="88176-116">The following information is displayed on the **Queries** page of the Bulk Search Editor.</span></span> 
    
    ![[大量搜尋編輯器] 頁面上會顯示所選的搜尋查詢](media/189659af-cc78-4479-b0bc-a93decad2f6c.png)
  
    <span data-ttu-id="88176-118">a.</span><span class="sxs-lookup"><span data-stu-id="88176-118">a.</span></span> <span data-ttu-id="88176-119">[**搜尋**] 欄中顯示的內容搜尋的名稱。</span><span class="sxs-lookup"><span data-stu-id="88176-119">The **Search** column displays the name of the Content Search.</span></span> <span data-ttu-id="88176-120">如先前所述，您可以編輯多個搜尋的查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-120">As previously stated, you can edit the query for multiple searches.</span></span> 
    
    <span data-ttu-id="88176-121">b.</span><span class="sxs-lookup"><span data-stu-id="88176-121">b.</span></span> <span data-ttu-id="88176-122">[**查詢**] 欄會顯示 [**搜尋**] 欄中所列的內容搜尋查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-122">The **Query** column displays the query for the Content Search listed in the **Search** column.</span></span> <span data-ttu-id="88176-123">如果使用關鍵字清單] 功能建立查詢，以文字分隔關鍵字 \* \* `(c:s)` **。這表示關鍵字由**OR\*\*運算子連線。此外，如果查詢包含條件，關鍵字和條件則以分隔文字 \* \* `(c:c)` \*\*。</span><span class="sxs-lookup"><span data-stu-id="88176-123">If the query was created using the keyword list feature, the keywords are separated by the text \*\* `(c:s)`**. This indicates that the keywords are connected by the **OR** operator. Additionally, if the query includes conditions, the keywords and the conditions are separated by the text \*\* `(c:c)`**.</span></span> <span data-ttu-id="88176-124">這表示的關鍵字 （或關鍵字階段） 條件連接所連接**AND**運算子。</span><span class="sxs-lookup"><span data-stu-id="88176-124">This indicates that the keywords (or keyword phases) are connected to the conditions by the **AND** operator.</span></span> <span data-ttu-id="88176-125">例如，在先前的螢幕擷取畫面搜尋 ContosoSearch1，KQL 查詢，相當於`customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)`就是`(customer OR pricing) AND (date=2002-01-01..2016-09-30)`。</span><span class="sxs-lookup"><span data-stu-id="88176-125">For example, in the previous screenshot the for search ContosoSearch1, the KQL query that is equivalent to  `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` would be  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`.</span></span>
    
3. <span data-ttu-id="88176-126">若要編輯的查詢，按一下您想要變更，並執行下列其中一個下列事項查詢的儲存格。</span><span class="sxs-lookup"><span data-stu-id="88176-126">To edit a query, click in the cell of the query that you want to change and doing one of the following things.</span></span> <span data-ttu-id="88176-127">請注意，該儲存格會加上藍色方塊在按一下時。</span><span class="sxs-lookup"><span data-stu-id="88176-127">Note that the cell is bordered by a blue box when you click it.</span></span>
    
   - <span data-ttu-id="88176-128">在儲存格中輸入新的查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-128">Type the new query in the cell.</span></span> <span data-ttu-id="88176-129">請注意，您無法編輯查詢的一部分。</span><span class="sxs-lookup"><span data-stu-id="88176-129">Note that you can't edit a portion of the query.</span></span> <span data-ttu-id="88176-130">您必須輸入整個查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-130">You have to type the entire query.</span></span>
    
      <span data-ttu-id="88176-131">Or</span><span class="sxs-lookup"><span data-stu-id="88176-131">Or</span></span>
    
    - <span data-ttu-id="88176-132">在儲存格中，貼上新的查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-132">Paste a new query in the cell.</span></span> <span data-ttu-id="88176-133">本範例假設您已複製查詢文字從一個檔案，例如文字檔案或 Excel 檔案。</span><span class="sxs-lookup"><span data-stu-id="88176-133">This assumes that you've copied the query text from a file, such as a text file or an Excel file.</span></span>
    
4. <span data-ttu-id="88176-134">您已編輯 [**查詢**] 頁面上的一或多個查詢之後，按一下 [**儲存**]。</span><span class="sxs-lookup"><span data-stu-id="88176-134">After you've edited one or more queries on the **Queries** page, click **Save**.</span></span>
    
    <span data-ttu-id="88176-135">修訂的查詢會顯示在選取的搜尋**查詢**] 欄中。</span><span class="sxs-lookup"><span data-stu-id="88176-135">The revised query is displayed in the **Query** column for the selected search.</span></span> 
    
5. <span data-ttu-id="88176-136">按一下 [**關閉**] 以關閉 [大量搜尋編輯器]。</span><span class="sxs-lookup"><span data-stu-id="88176-136">Click **Close** to close the Bulk Search Editor.</span></span> 
    
6. <span data-ttu-id="88176-137">在**內容搜尋**] 頁面上，選擇 [搜尋] 編輯，然後按一下 [**開始**搜尋] 以重新啟動搜尋使用修訂的查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-137">On the **Content search** page, select the search that you edited, and click **Start** search to restart the search using the revised query.</span></span> 
    
<span data-ttu-id="88176-138">以下是一些祕訣編輯查詢使用大量搜尋編輯器：</span><span class="sxs-lookup"><span data-stu-id="88176-138">Here are some tips for editing queries using the Bulk Search Editor:</span></span>
  
- <span data-ttu-id="88176-139">將現有的查詢 （藉由使用**Ctrl C** ） 複製到文字檔案。</span><span class="sxs-lookup"><span data-stu-id="88176-139">Copy the existing query (by using **Ctrl C** ) to a text file.</span></span> <span data-ttu-id="88176-140">編輯在文字檔案中，查詢，然後將修改過的查詢複製並將它貼 （使用**Ctrl V** ） 回 [**查詢**] 頁面上的儲存格。</span><span class="sxs-lookup"><span data-stu-id="88176-140">Edit the query in the text file, and then copy the revised query and paste it (using **Ctrl V** ) back into the cell on the **Queries** page.</span></span> 
    
- <span data-ttu-id="88176-141">您也可以從其他應用程式 （例如 Microsoft Word 或 Microsoft Excel） 複製查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-141">You can also copy queries from other applications (such as Microsoft Word or Microsoft Excel).</span></span> <span data-ttu-id="88176-142">然而，請注意，您可能不小心將新增不支援的字元至查詢使用大量搜尋編輯器。</span><span class="sxs-lookup"><span data-stu-id="88176-142">However, be aware that you might inadvertently add unsupported characters to a query using the Bulk Search Editor.</span></span> <span data-ttu-id="88176-143">若要防止不支援的字元，最好是只類型中的儲存格上 [**查詢**] 頁面上的查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-143">The best way to prevent unsupported characters is to just type the query in a cell on the **Queries** page.</span></span> <span data-ttu-id="88176-144">或者，您可以從 Word 或 Excel 複製查詢，並再將它的純文字編輯器，Microsoft [記事本] 之類的檔案貼。</span><span class="sxs-lookup"><span data-stu-id="88176-144">Alternatively, you can copy a query from Word or Excel and then paste it to file in a plain text editor, such as Microsoft Notepad.</span></span> <span data-ttu-id="88176-145">然後儲存為文字檔，並在 [**編碼**] 下拉式清單中選取**ANSI** 。</span><span class="sxs-lookup"><span data-stu-id="88176-145">Then save the text file and select **ANSI** in the **Encoding** drop-down list.</span></span> <span data-ttu-id="88176-146">這會移除任何格式設定與不支援的字元。</span><span class="sxs-lookup"><span data-stu-id="88176-146">This will remove any formatting and unsupported characters.</span></span> <span data-ttu-id="88176-147">然後您可以複製並貼上 [**查詢**] 頁面上的文字檔案中查詢。</span><span class="sxs-lookup"><span data-stu-id="88176-147">Then you can copy and paste the query from the text file to the **Queries** page.</span></span> 
    
  
## <a name="use-the-bulk-search-editor-to-change-content-locations"></a><span data-ttu-id="88176-148">使用大量搜尋編輯器]，以變更內容的位置</span><span class="sxs-lookup"><span data-stu-id="88176-148">Use the Bulk Search Editor to change content locations</span></span>

1. <span data-ttu-id="88176-149">在大量搜尋編輯器中的一或多個選取的搜尋，按一下 [**啟用大量位置編輯器**]，然後按一下 [頁面顯示的 [**位置**] 連結。</span><span class="sxs-lookup"><span data-stu-id="88176-149">In the Bulk Search Editor for one or more selected searches, click **Enable bulk location editor**, and then click the **Locations** link that is displayed on the page.</span></span> 
    
    <span data-ttu-id="88176-150">在 [大量搜尋編輯器] 的 [**位置**] 頁面上，會顯示下列資訊。</span><span class="sxs-lookup"><span data-stu-id="88176-150">The following information is displayed on the **Locations** page of the Bulk Search Editor.</span></span> 
    
    ![按一下 [啟用大量位置編輯器，然後按一下 [新增或移除內容位置的位置](media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)
  
    <span data-ttu-id="88176-152">a.</span><span class="sxs-lookup"><span data-stu-id="88176-152">a.</span></span> <span data-ttu-id="88176-153">**若要搜尋的信箱**此區段會顯示每個選取的內容搜尋及每個信箱，包含在搜尋列資料行。</span><span class="sxs-lookup"><span data-stu-id="88176-153">**Mailboxes to search**This section displays a column for each selected Content Search, and row for each mailbox that's included in the search.</span></span> <span data-ttu-id="88176-154">核取記號表示信箱包含在搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-154">A checkmark indicates that the mailbox is included in the search.</span></span> <span data-ttu-id="88176-155">您可以新增至搜尋其他信箱一個空白列中輸入信箱的電子郵件地址，然後按一下您想要將它新增內容搜尋] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-155">You can add additional mailboxes to a search by typing the email address of the mailbox in a blank row and then clicking the checkbox for the Content Search that you want to add it to.</span></span> <span data-ttu-id="88176-156">或者，您可以移除信箱搜尋清除該核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-156">Or you can remove a mailbox from a search by clearing the checkbox.</span></span>
    
    <span data-ttu-id="88176-157">b.</span><span class="sxs-lookup"><span data-stu-id="88176-157">b.</span></span> <span data-ttu-id="88176-158">**若要搜尋的 SharePoint 網站**此區段會顯示每個選取的內容搜尋中包含每個 SharePoint 和 OneDrive 網站的資料列。</span><span class="sxs-lookup"><span data-stu-id="88176-158">**SharePoint sites to search**This section displays a row for each SharePoint and OneDrive site that included in each selected Content Search.</span></span> <span data-ttu-id="88176-159">核取記號表示網站包含在搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-159">A checkmark indicates that the site is included in the search.</span></span> <span data-ttu-id="88176-160">您也可以在一個空白列中輸入網站的 URL 搜尋新增額外的網站，然後再按一下核取方塊內容搜尋您想要將其新增至。</span><span class="sxs-lookup"><span data-stu-id="88176-160">You can add additional sites to a search by typing the URL for the site in a blank row and then and clicking the checkbox for the Content Search that you want to add it to.</span></span> <span data-ttu-id="88176-161">或者，您可以移除網站搜尋清除該核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-161">Or you can remove a site from a search by clearing the checkbox.</span></span>
    
    <span data-ttu-id="88176-162">c.</span><span class="sxs-lookup"><span data-stu-id="88176-162">c.</span></span> <span data-ttu-id="88176-163">**其他搜尋選項**此區段表示未編製索引的項目及公用資料夾都包含在搜尋]。</span><span class="sxs-lookup"><span data-stu-id="88176-163">**Other search options**This section indicates whether unindexed items and public folders are included in the search.</span></span> <span data-ttu-id="88176-164">若要包含這些，確定核取方塊已選取。</span><span class="sxs-lookup"><span data-stu-id="88176-164">To include these, make sure the checkbox is selected.</span></span> <span data-ttu-id="88176-165">若要移除它們，請清除核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-165">To remove them, clear the checkbox.</span></span>
    
2. <span data-ttu-id="88176-166">您已編輯一或多個**位置**] 頁面上的章節之後，按一下 [**儲存**。</span><span class="sxs-lookup"><span data-stu-id="88176-166">After you've edited one or more of the sections on the **Locations** page, click **Save**.</span></span>
    
    <span data-ttu-id="88176-167">修訂內容的位置會顯示在適當] 區段中，選取搜尋。</span><span class="sxs-lookup"><span data-stu-id="88176-167">The revised content locations are displayed in the appropriate section for the selected searches.</span></span>
    
3. <span data-ttu-id="88176-168">按一下 [**關閉**] 以關閉 [大量搜尋編輯器]。</span><span class="sxs-lookup"><span data-stu-id="88176-168">Click **Close** to close the Bulk Search Editor.</span></span> 
    
4. <span data-ttu-id="88176-169">在**內容搜尋**] 頁面上，選擇 [搜尋] 編輯，然後按一下 [**開始**搜尋] 以重新啟動搜尋使用的修訂的內容位置。</span><span class="sxs-lookup"><span data-stu-id="88176-169">On the **Content search** page, select the search that you edited, and click **Start** search to restart the search using the revised content locations.</span></span> 
    
<span data-ttu-id="88176-170">以下是編輯使用大量搜尋編輯器的內容位置的一些秘訣：</span><span class="sxs-lookup"><span data-stu-id="88176-170">Here are some tips for editing content locations using the Bulk Search Editor:</span></span>
  
- <span data-ttu-id="88176-171">您可以編輯內容搜尋來搜尋所有信箱或網站中的組織中**要都搜尋信箱**或**SharePoint 網站新增至都搜尋**] 區段中的空白資料列中輸入**所有**，然後按一下核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-171">You can edit Content Searches to search all mailboxes or sites in the organization by typing **All** in a blank row in the **Mailboxes to search** or **SharePoint sites to search** section and then clicking the checkbox.</span></span> 
    
- <span data-ttu-id="88176-172">您可以新增至一或多個搜尋內容的多個位置的文字檔案或 Excel 檔案，複製多個資料列並再將它們貼到] 區段的 [**位置**] 頁面上。</span><span class="sxs-lookup"><span data-stu-id="88176-172">You can add multiple content locations to one or more searches by copying multiple rows from a text file or an Excel file and then pasting them to a section on the **Locations** page.</span></span> <span data-ttu-id="88176-173">新增新的位置之後，請務必選取您想要的位置新增每個搜尋的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="88176-173">After you add new locations, be sure to select the checkbox for each search that you want add the location to.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="88176-174">若要在組織中產生的所有使用者的電子郵件地址清單，請[使用內容搜尋來搜尋信箱與 OneDrive for Business 網站的使用者清單](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step2)中的步驟 2 中執行 PowerShell 命令。</span><span class="sxs-lookup"><span data-stu-id="88176-174">To generate a list of email addresses for all the users in your organization, run the PowerShell command in Step 2 in [Use Content Search to search the mailbox and OneDrive for Business site for a list of users](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step2).</span></span> <span data-ttu-id="88176-175">或使用指令碼[建立的組織中的所有 OneDrive 位置清單](https://support.office.com/article/8e200cb2-c768-49cb-88ec-53493e8ad80a)中，產生您組織中的所有 OneDrive for Business 網站的清單。</span><span class="sxs-lookup"><span data-stu-id="88176-175">Or use the script in [Create a list of all OneDrive locations in your organization](https://support.office.com/article/8e200cb2-c768-49cb-88ec-53493e8ad80a) to generate a list of all OneDrive for Business sites in your organization.</span></span> <span data-ttu-id="88176-176">請注意，您必須附加的 URL 您的組織的我的網站網域 (例如，https://contoso-my.sharepoint.com)至 OneDrive for Business 網站所建立的指令碼。</span><span class="sxs-lookup"><span data-stu-id="88176-176">Note that you'll have to append the URL for your's organization's MySite domain (for example, https://contoso-my.sharepoint.com) to the OneDrive for Business sites that's created by the script.</span></span> <span data-ttu-id="88176-177">您的電子郵件地址或 OneDrive for Business 網站的清單之後，您可以複製，並將它們貼到 [大量搜尋編輯器] 中的 [**位置**] 頁面上。</span><span class="sxs-lookup"><span data-stu-id="88176-177">After you have list of email addresses or OneDrive for Business sites, you can copy and paste them to the **Locations** page in the Bulk Search Editor.</span></span> 
  
- <span data-ttu-id="88176-178">按一下 [**儲存**] 以儲存大量搜尋編輯器] 中的變更之後，將會驗證您已新增至搜尋的信箱的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="88176-178">After you click **Save** to save changes in Bulk Search Editor, the email address for mailboxes that you added to a search will be validated.</span></span> <span data-ttu-id="88176-179">如果不存在的電子郵件地址，會顯示錯誤訊息，指出找不到信箱。</span><span class="sxs-lookup"><span data-stu-id="88176-179">If the email address doesn't exist, an error message is displayed saying the mailbox can't be located.</span></span> <span data-ttu-id="88176-180">請注意未驗證網站的 Url。</span><span class="sxs-lookup"><span data-stu-id="88176-180">Note that URLs for sites aren't validated.</span></span> 
  

