---
title: Office 365 Exchange 線上資料刪除
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: 如何軟及完全資料刪除全天候內 Exchange Online。
ms.openlocfilehash: 879d4a0351720780667333502c6caa30dffc8996
ms.sourcegitcommit: c94cb88a9ce5bcc2d3c558f0fcc648519cc264a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/20/2019
ms.locfileid: "30090735"
---
# <a name="exchange-online-data-deletion-in-office-365"></a><span data-ttu-id="750d6-103">Office 365 中的 Exchange Online 資料刪除</span><span class="sxs-lookup"><span data-stu-id="750d6-103">Exchange Online Data Deletion in Office 365</span></span>
<span data-ttu-id="750d6-p101">Exchange Online 中，有兩種類型的刪除： 軟體的刪除和硬碟的刪除。這適用於信箱與信箱內的項目。</span><span class="sxs-lookup"><span data-stu-id="750d6-p101">Within Exchange Online, there are two kinds of deletions: soft deletions and hard deletions. This applies to both mailboxes and items within a mailbox.</span></span>

## <a name="soft-deleted-and-hard-deleted-mailboxes"></a><span data-ttu-id="750d6-106">虛刪除和硬碟已刪除的信箱</span><span class="sxs-lookup"><span data-stu-id="750d6-106">Soft-Deleted and Hard-Deleted Mailboxes</span></span>
<span data-ttu-id="750d6-p102">虛刪除使用者信箱都使用 Office 365 系統管理中心或 Remove-mailbox 指令程式已刪除，仍有 Azure Active Directory 資源回收筒中已早於 30 天的信箱。信箱會變得虛刪除任何下列兩種：</span><span class="sxs-lookup"><span data-stu-id="750d6-p102">A soft-deleted user mailbox is a mailbox that has been deleted using the Office 365 admin center or the Remove-Mailbox cmdlet and has still been in the Azure Active Directory recycle bin for less than 30 days. A mailbox can become soft-deleted in any of the following ways:</span></span>
- <span data-ttu-id="750d6-109">使用者信箱的相關聯 Azure Active Directory 使用者帳戶是虛刪除 （使用者物件會超出範圍或資源回收筒] 容器中）。</span><span class="sxs-lookup"><span data-stu-id="750d6-109">The user mailbox's associated Azure Active Directory user account is soft-deleted (the user object is out of scope or in the recycle bin container).</span></span>
- <span data-ttu-id="750d6-110">使用者信箱的相關聯的 Azure Active Directory 使用者帳戶已完全刪除，但 Exchange Online 信箱處於訴訟暫止狀態下或 eDiscovery 保留。</span><span class="sxs-lookup"><span data-stu-id="750d6-110">The user mailbox's associated Azure Active Directory user account has been hard-deleted but the Exchange Online mailbox is under a litigation hold or eDiscovery hold.</span></span>
- <span data-ttu-id="750d6-111">使用者信箱的相關聯的 Azure Active Directory 使用者帳戶具有已清除過去 30 天; 內這是 Exchange Online 的最大保留長度會保持信箱虛刪除狀態之前永久就且無法復原。</span><span class="sxs-lookup"><span data-stu-id="750d6-111">The user mailbox's associated Azure Active Directory user account has been purged within the last 30 days; which is the maximum retention length Exchange Online will keep the mailbox in a soft-deleted state before it is permanently purged and unrecoverable.</span></span>

<span data-ttu-id="750d6-112">硬碟刪除使用者信箱已透過下列方式之一已刪除的信箱：</span><span class="sxs-lookup"><span data-stu-id="750d6-112">A hard-deleted user mailbox is a mailbox that has been deleted in one of the following ways:</span></span>
- <span data-ttu-id="750d6-p103">使用者信箱已虛刪除超過 30 天和相關聯的 Azure Active Directory 使用者已固定刪除。永久刪除電子郵件、 連絡人及檔案等的所有信箱內容。</span><span class="sxs-lookup"><span data-stu-id="750d6-p103">The user mailbox has been soft-deleted for more than 30 days, and the associated Azure Active Directory user has been hard-deleted. All mailbox content such as emails, contacts and files are permanently deleted.</span></span>
- <span data-ttu-id="750d6-p104">硬碟刪除 Azure Active Directory 中已與使用者信箱關聯的使用者帳戶。使用者信箱現已在 Exchange Online 虛刪除和 30 天的會停留在虛刪除的狀態。如果在 30 天的期間將新的 Azure Active Directory 使用者從同步處理具有相同的**ExchangeGuid**或**ArchiveGuid**、 原始收件者帳戶的新帳戶授權的 Exchange Online，這會導致硬刪除原始的使用者信箱。永久刪除電子郵件、 連絡人及檔案等的所有信箱內容。</span><span class="sxs-lookup"><span data-stu-id="750d6-p104">The user account associated with the user mailbox has been hard-deleted from the Azure Active Directory. The user mailbox is now soft-deleted in Exchange Online and stays in a soft-deleted state for 30 days. If in the 30-day period a new Azure Active Directory user is synchronized from the original recipient account with the same **ExchangeGuid** or **ArchiveGuid**, and that new account is licensed for Exchange Online, this will result in a hard deletion of the original user mailbox. All mailbox content such as emails, contacts and files are permanently deleted.</span></span>
- <span data-ttu-id="750d6-119">使用**Remove-mailbox PermanentlyDelete**刪除虛刪除信箱。</span><span class="sxs-lookup"><span data-stu-id="750d6-119">A soft-deleted mailbox is deleted using **Remove-Mailbox -PermanentlyDelete**.</span></span>

<span data-ttu-id="750d6-p105">上述的刪除案例假設使用者信箱不在任何 [保留] 狀態訴訟暫止或 eDiscovery 保留。如果沒有任何類型的信箱上保留，無法刪除信箱。所有郵件使用者收件者類型、[保留](https://support.office.com/article/manage-legal-investigations-in-office-365-2e5fbe9f-ee4d-4178-8ff8-4356bc1b168e?ui=en-US&rs=en-US&ad=US)的任何設定會略過且不會影響硬刪除或虛刪除。</span><span class="sxs-lookup"><span data-stu-id="750d6-p105">The above deletion scenarios assume that the user mailbox isn't in any of the hold states, like Litigation hold or eDiscovery hold. If there is any type of hold on the mailbox, then the mailbox can't be deleted. For all mail-user recipient types, any [Hold](https://support.office.com/article/manage-legal-investigations-in-office-365-2e5fbe9f-ee4d-4178-8ff8-4356bc1b168e?ui=en-US&rs=en-US&ad=US) settings are ignored and have no effect on hard-deletions or soft-deletions.</span></span>

## <a name="soft-deleted-and-hard-deleted-items"></a><span data-ttu-id="750d6-123">虛刪除與硬刪除項目</span><span class="sxs-lookup"><span data-stu-id="750d6-123">Soft-Deleted and Hard-Deleted Items</span></span>
<span data-ttu-id="750d6-p106">當使用者刪除的信箱項目 （例如電子郵件、 連絡人、 行事曆約會或工作） 時、 項目移至 [可復原的項目] 資料夾中，並將名為刪除的子資料夾。這被稱為柔刪除。長已刪除的項目存留在資料夾取決於刪除項目保留期間設定信箱刪除作業中。Exchange Online 信箱 14 天內刪除的項目會依預設，但 Exchange Online 系統管理員可變更此設定可增加到最大值為 30 天的期間。（如增加 Exchange Online 信箱已刪除的項目保留期間的詳細步驟，請參閱[Exchange Online 信箱之保留時間變更多久永久刪除項目](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention)）。使用者可以復原，或是清除已刪除項目的保留時間到期之前刪除的項目。若要這樣做，他們必須使用 Microsoft Outlook 或 Outlook web 上的復原刪除的郵件功能。</span><span class="sxs-lookup"><span data-stu-id="750d6-p106">When a user deletes a mailbox item (such as an email message, a contact, a calendar appointment, or a task), the item is moved to the Recoverable Items folder, and into a subfolder named Deletions. This is referred to as a soft deletion. How long deleted items are kept in the Deletions folder depends on the deleted item retention period that is set for the mailbox. An Exchange Online mailbox keeps deleted items for 14 days by default, but Exchange Online administrators can change this setting to increase the period up to a maximum of 30 days. (For detailed steps to increase the deleted item retention period for an Exchange Online mailbox, see [Change how long permanently deleted items are kept for an Exchange Online mailbox](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention).) Users can recover, or purge, deleted items before the retention time for a deleted item expires. To do so, they use the Recover Deleted Items feature in Microsoft Outlook or Outlook on the web.</span></span>

<span data-ttu-id="750d6-p107">如果使用者使用 Outlook 或 Outlook web 上的復原刪除的郵件功能清除已刪除的項目，這就是所謂的硬碟的刪除。在 Exchange Online 中，單一項目復原預設會啟用時建立新的信箱時，讓系統管理員可以仍[復原](https://docs.microsoft.com/Exchange/recipients/user-mailboxes/recover-deleted-messages)硬碟已刪除的項目之前刪除項目保留期間到期。此外，如果使用者或程序來變更一則訊息，原始項目的複本時，會也保留啟用單一項目復原。</span><span class="sxs-lookup"><span data-stu-id="750d6-p107">If a user purges a deleted item by using the Recover Deleted Items feature in Outlook or Outlook on the web, this is known as a hard deletion. In Exchange Online, single item recovery is enabled by default when a new mailbox is created, so an administrator can still [recover](https://docs.microsoft.com/Exchange/recipients/user-mailboxes/recover-deleted-messages) hard-deleted items before the deleted item retention period expires. Also, if a message is changed by a user or a process, copies of the original item are also retained when single item recovery is enabled.</span></span>

## <a name="page-zeroing"></a><span data-ttu-id="750d6-133">清空分頁</span><span class="sxs-lookup"><span data-stu-id="750d6-133">Page Zeroing</span></span>
<span data-ttu-id="750d6-p108">*Zeroing*是零或二進位圖樣覆寫已刪除的資料使是更難復原已刪除的資料安全性機制。在 Exchange Online 信箱資料庫*頁面*作為儲存其單位並實作呼叫*分頁清空*覆寫程序。分頁清空功能根據預設，而且不能由客戶或 Microsoft 停用。頁面清空作業會記錄在交易記錄檔中，讓所有指定的資料庫副本頁面-分頁清空類似的方式。清空上作用中資料庫副本的頁面會使要取得之資料庫的被動副本分頁清空的頁面。</span><span class="sxs-lookup"><span data-stu-id="750d6-p108">*Zeroing* is a security mechanism that writes either zeros or a binary pattern over deleted data so that the deleted data is more difficult to recover. In Exchange Online, mailbox databases use *pages* as their unit of storage, and implement an overwriting process called *page zeroing*. Page zeroing is enabled by default, and it cannot be disabled by customers or by Microsoft. Page zeroing operations are recorded in the transaction log files so that all copies of a given database are page-zeroed in a similar manner. Zeroing a page on an active database copy causes the page to get zeroed on passive copies of the database.</span></span>

<span data-ttu-id="750d6-p109">分頁清空透過硬刪除記錄中寫入二進位圖樣。分頁清空模式特定 （內部資料庫引擎的名稱伺服器所用在 Exchange Online） 可延伸儲存引擎 (ESE) 作業，而且可相當不同的執行階段作業與背景資料庫維護作業。（背景資料庫維護是持續總和檢查碼掃瞄每個資料庫和程序。其主要功能是總和檢查碼資料庫頁面，但它也會處理清理空間和清空出記錄與已不分頁清空出因為存放區損毀的頁面）。</span><span class="sxs-lookup"><span data-stu-id="750d6-p109">Page zeroing writes a binary pattern over hard-deleted records. The page-zeroing pattern is specific to Extensible Storage Engine (ESE) operations (the name of the internal database engine used by servers in Exchange Online), and it is different for run-time operations versus background database maintenance operations. (Background database maintenance is a process that continuously checksums and scans each database. Its primary function is to checksum database pages, but it also handles cleaning up space and zeroing out records and pages that were not zeroed out because of a Store crash.)</span></span>

<span data-ttu-id="750d6-143">下表列出對應至特定執行階段作業的填滿圖樣。</span><span class="sxs-lookup"><span data-stu-id="750d6-143">The following table lists the fill patterns that correspond to specific run-time operations.</span></span>

| <span data-ttu-id="750d6-144">ESE 執行階段作業</span><span class="sxs-lookup"><span data-stu-id="750d6-144">ESE run-time operation</span></span>   | <span data-ttu-id="750d6-145">填滿圖樣</span><span class="sxs-lookup"><span data-stu-id="750d6-145">Fill pattern</span></span> |
|--------------------------|--------------|
| <span data-ttu-id="750d6-146">取代</span><span class="sxs-lookup"><span data-stu-id="750d6-146">Replace</span></span>                  | <span data-ttu-id="750d6-147">R</span><span class="sxs-lookup"><span data-stu-id="750d6-147">R</span></span>            |
| <span data-ttu-id="750d6-148">記錄/長數值刪除</span><span class="sxs-lookup"><span data-stu-id="750d6-148">Record/long value delete</span></span> | <span data-ttu-id="750d6-149">D</span><span class="sxs-lookup"><span data-stu-id="750d6-149">D</span></span>            |
| <span data-ttu-id="750d6-150">釋放的頁面空間</span><span class="sxs-lookup"><span data-stu-id="750d6-150">Freed page space</span></span>         | <span data-ttu-id="750d6-151">H</span><span class="sxs-lookup"><span data-stu-id="750d6-151">H</span></span>            |


<span data-ttu-id="750d6-152">下表列出對應至特定作業的填滿圖樣，這些作業是在 ESE 背景資料庫維護期間進行。</span><span class="sxs-lookup"><span data-stu-id="750d6-152">The following table lists the fill patterns that correspond to specific operations that occur during ESE background database maintenance.</span></span>

| <span data-ttu-id="750d6-153">ESE 背景資料庫維護作業</span><span class="sxs-lookup"><span data-stu-id="750d6-153">ESE background database maintenance operation</span></span> | <span data-ttu-id="750d6-154">填滿圖樣</span><span class="sxs-lookup"><span data-stu-id="750d6-154">Fill pattern</span></span> |
|-----------------------------------------------|--------------|
| <span data-ttu-id="750d6-155">記錄刪除</span><span class="sxs-lookup"><span data-stu-id="750d6-155">Record delete</span></span>                                 | <span data-ttu-id="750d6-156">D</span><span class="sxs-lookup"><span data-stu-id="750d6-156">D</span></span>            |
| <span data-ttu-id="750d6-157">長數值刪除</span><span class="sxs-lookup"><span data-stu-id="750d6-157">Long value delete</span></span>                             | <span data-ttu-id="750d6-158">L</span><span class="sxs-lookup"><span data-stu-id="750d6-158">L</span></span>            |
| <span data-ttu-id="750d6-159">部分使用頁面的已釋放頁面空間</span><span class="sxs-lookup"><span data-stu-id="750d6-159">Freed page space of partially used page</span></span>       | <span data-ttu-id="750d6-160">Z</span><span class="sxs-lookup"><span data-stu-id="750d6-160">Z</span></span>            |
| <span data-ttu-id="750d6-161">未使用頁面的已釋放頁面空間</span><span class="sxs-lookup"><span data-stu-id="750d6-161">Freed page space of unused page</span></span>               | <span data-ttu-id="750d6-162">U</span><span class="sxs-lookup"><span data-stu-id="750d6-162">U</span></span>            |


### <a name="page-zeroing-process"></a><span data-ttu-id="750d6-163">頁面清空程序</span><span class="sxs-lookup"><span data-stu-id="750d6-163">Page Zeroing Process</span></span>
<span data-ttu-id="750d6-p110">分頁清空的程序取決於刪除案例。下表討論資料庫刪除案例、 與頁面清空功能發生的時間。</span><span class="sxs-lookup"><span data-stu-id="750d6-p110">The process for page zeroing depends on the deletion scenario. The following table discusses database delete scenarios, and when page zeroing functions occur.</span></span>

| <span data-ttu-id="750d6-166">資料庫刪除案例</span><span class="sxs-lookup"><span data-stu-id="750d6-166">Database delete scenario</span></span> | <span data-ttu-id="750d6-167">清空資料庫資料 的 ESE 處理程序和時段</span><span class="sxs-lookup"><span data-stu-id="750d6-167">ESE process and timeframe to zero database data</span></span> |
|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="750d6-168">項目過期取決於刪除項目保留期間。</span><span class="sxs-lookup"><span data-stu-id="750d6-168">Item expires based on the deleted item retention period.</span></span> | <span data-ttu-id="750d6-p111">非同步執行緒會以二進位模式覆寫刪除的資料。此動作會在記錄刪除的幾毫秒內發生。如果儲存區處理程序在非同步清空工作仍未完成時損毀 (或者由於版本儲存區成長而取消版本儲存區清理)，則會在背景資料庫維護處理該區段的資料庫時完成清空。</span><span class="sxs-lookup"><span data-stu-id="750d6-p111">An asynchronous thread writes a binary pattern over the deleted data. This action occurs within milliseconds of the record deletion. If the Store process crashes while the asynchronous zeroing work is still outstanding (or version store cleanup is cancelled due to version store growth), the zeroing is completed when background database maintenance processes that section of the database.</span></span> |
| <span data-ttu-id="750d6-172">檢視案例： 到期上的項目從 Outlook/Outlook web 資料夾檢視 （例如交談] 檢視）</span><span class="sxs-lookup"><span data-stu-id="750d6-172">View Scenario: Expiration of items from Outlook/Outlook on the web folder view (for example, Conversation view)</span></span> | <span data-ttu-id="750d6-173">資料清空會在背景資料庫維護處理該區段的資料庫時進行。</span><span class="sxs-lookup"><span data-stu-id="750d6-173">Data zeroing occurs when background database maintenance processes that section of the database.</span></span> |
| <span data-ttu-id="750d6-174">移動信箱/刪除信箱案例： 刪除來源信箱 （刪除的信箱到期）</span><span class="sxs-lookup"><span data-stu-id="750d6-174">Move Mailbox/Delete Mailbox Scenario: Source mailbox deleted (expiry of deleted mailbox)</span></span> | <span data-ttu-id="750d6-175">資料清空會在背景資料庫維護處理該區段的資料庫時進行。</span><span class="sxs-lookup"><span data-stu-id="750d6-175">Data zeroing occurs when background database maintenance processes that section of the database.</span></span> |

### <a name="mailbox-data-types-without-page-zeroing"></a><span data-ttu-id="750d6-176">不清空分頁的信箱資料類型</span><span class="sxs-lookup"><span data-stu-id="750d6-176">Mailbox Data Types without Page Zeroing</span></span>
<span data-ttu-id="750d6-177">下列信箱資料類型有無佈建分頁清空：</span><span class="sxs-lookup"><span data-stu-id="750d6-177">The following mailbox data types have no provisions for page zeroing:</span></span>
- <span data-ttu-id="750d6-p112">**信箱資料庫交易記錄檔**-交易記錄檔在刪除後正常作業的一部分，沒有為零封鎖儲存已刪除的記錄檔案的目錄檔案系統中的處理序。很可能檔案系統將快速重新運用該可用空間的新建立的記錄檔，但不保證這個情形。</span><span class="sxs-lookup"><span data-stu-id="750d6-p112">**Mailbox database transaction logs** - When transaction logs are deleted as part of normal operations, there is no process to zero the blocks in the file system that stored the deleted log file(s). It's likely that the file system will quickly re-utilize that free space for newly created logs, but there is no guarantee that this will happen.</span></span>
- <span data-ttu-id="750d6-p113">**內容索引類別目錄檔案**-Exchange Online 使用 Search Foundation (也稱為 FAST) 來進行搜尋編製索引的功能。搜尋索引類別目錄是由數個數十個檔案儲存在相同的磁碟區為信箱資料庫檔案所組成。當郵件為硬-從資料庫中刪除信箱時，不是立即刪除搜尋目錄中相關聯的內容。Search Foundation 沒有時發生內容刪除許多小型類別目錄檔案中為單一大型檔案陰影 （或主要合併）。主要合併完成後，會刪除較小的類別目錄檔案。沒有為零的組塊儲存已刪除的類別目錄檔案的程序。</span><span class="sxs-lookup"><span data-stu-id="750d6-p113">**Content index catalog files** - Exchange Online uses Search Foundation (also known as FAST) for search indexing functionality. The search index catalog is comprised of several dozen files stored on the same volume as the mailbox database file. When a message is hard-deleted from the mailbox database, the associated content in the search catalog isn't immediately deleted. Content deletion occurs when Search Foundation does a shadow (or master merge) of many small catalog files in to a single larger file. After the master merge completes, the smaller catalog files are deleted. There is no process to zero the blocks which stored the deleted catalog files.</span></span>

## <a name="continuous-replication"></a><span data-ttu-id="750d6-186">連續複寫</span><span class="sxs-lookup"><span data-stu-id="750d6-186">Continuous Replication</span></span>
<span data-ttu-id="750d6-p114">連續複寫 （也稱為記錄傳送和重新顯示） 是 Exchange Online 中建立並維護每個提供高可用性、 站台恢復及災害復原的信箱資料庫複本的技術。連續複寫如何運用提供執行非同步方式更新一或多個信箱資料庫副本的技術的 Exchange Server 資料庫損毀修復支援。每部信箱伺服器會記錄在作用中的資料庫 （例如，使用者電子郵件活動） 進行的資料庫更新為循序集 1 MB 交易記錄檔中的記錄檔記錄。此組檔案稱為記錄資料流。連續複寫的記錄資料流也用來以非同步方式更新一或多個資料庫副本。這藉由傳輸記錄檔來包含使用中資料庫的被動副本及再加以重新將被動資料庫副本的位置。如果現用資料庫中的所有記錄檔會對資料庫的被動副本重新撥放，則這兩個資料庫都相等，並完成此程序是使用中的資料庫進行任何實體變更會複寫到所有被動資料庫副本。</span><span class="sxs-lookup"><span data-stu-id="750d6-p114">Continuous replication (also known as log shipping and replay) is technology in Exchange Online that creates and maintains copies of every mailbox database to provide high availability, site resilience, and disaster recovery. Continuous replication leverages the Exchange Server database crash recovery support to provide technology that performs asynchronous updating of one or more copies of a mailbox database. Each mailbox server records database updates made on an active database (for example, user email activity) as log records in a sequential set of 1 MB transaction log files. This set of files is referred to as the log stream. In continuous replication, the log stream is also used to asynchronously update one or more copies of a database. This is accomplished by transmitting the logs to a location containing a passive copy of the active database and then replaying them into the passive database copy. If all logs from the active database are replayed against a passive copy of the database, then the two databases are equivalent, and it is through this process that any physical change made to an active database is replicated to all passive copies of that database.</span></span>

<span data-ttu-id="750d6-p115">信箱資料庫、 從任何刪除已將信箱項目或整個信箱，以及是否虛刪除或完全刪除，代表的實體變更作用中的資料庫。分頁清空也主要變更實體作用中的資料庫。這些變更寫入記錄檔以透過呼叫連續複寫程序和被動資料庫時這些記錄檔已對應資料庫的被動副本，會有相同的實體變更。</span><span class="sxs-lookup"><span data-stu-id="750d6-p115">Any deletion from a mailbox database, whether a mailbox item or an entire mailbox, and whether a soft-delete or a hard-delete, represents a physical change to the active database. Page zeroing also entails making physical changes to the active database. These changes are written to the log files through a process called continuous replication, and when those log files are replayed against passive copies of the database, the same physical changes are made to those passive databases.</span></span>